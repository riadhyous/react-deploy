{"ast":null,"code":"import _regeneratorRuntime from \"/home/nino420/Desktop/Application_Seutnauce/ASPAdministrator/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/home/nino420/Desktop/Application_Seutnauce/ASPAdministrator/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/home/nino420/Desktop/Application_Seutnauce/ASPAdministrator/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/nino420/Desktop/Application_Seutnauce/ASPAdministrator/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/nino420/Desktop/Application_Seutnauce/ASPAdministrator/src/components/UploadImage.js\";\nimport React, { useState, useEffect } from 'react';\nimport firebase from '../util/firebase';\nimport { v4 as uuid } from 'uuid';\nexport default function UploadImage() {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      imageUrl = _useState2[0],\n      setImageUrl = _useState2[1];\n\n  var readImages =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(e) {\n      var file, id, storageRef, imageRef;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              file = e.target.files[0];\n              id = uuid();\n              storageRef = firebase.storage().ref('images').child(id);\n              imageRef = firebase.database().ref('images').child('daily').child(id);\n              _context.next = 6;\n              return storageRef.put(file);\n\n            case 6:\n              storageRef.getDownloadURL().then(function (url) {\n                imageRef.set(url);\n                var newState = [].concat(_toConsumableArray(imageUrl), [{\n                  id: id,\n                  url: url\n                }]);\n                setImageUrl(newState);\n              });\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function readImages(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var getImageUrl = function getImageUrl() {\n    var imageRef = firebase.database().ref('images').child('daily');\n    imageRef.on('value', function (snapshot) {\n      var imageUrls = snapshot.val();\n      var urls = [];\n\n      for (var id in imageUrls) {\n        urls.push({\n          id: id,\n          url: imageUrls[id]\n        });\n      }\n\n      var newState = [].concat(_toConsumableArray(imageUrl), urls);\n      setImageUrl(newState);\n    });\n  };\n\n  var deleteImage = function deleteImage(id) {\n    var storageRef = firebase.storage().ref('images').child(id);\n    var imageRef = firebase.database().ref('images').child('daily').child(id);\n    storageRef.delete().then(function () {\n      imageRef.remove();\n    });\n  };\n\n  useEffect(function () {\n    getImageUrl();\n  }, []);\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44\n    },\n    __self: this\n  }, \"Upload imgae\"), React.createElement(\"input\", {\n    type: \"file\",\n    accept: \"image/*\",\n    onChange: readImages,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45\n    },\n    __self: this\n  }), imageUrl ? imageUrl.map(function (_ref2) {\n    var id = _ref2.id,\n        url = _ref2.url;\n    return React.createElement(\"div\", {\n      key: id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: url,\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      onClick: function onClick() {\n        return deleteImage(id);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51\n      },\n      __self: this\n    }, \"Delete\"));\n  }) : '');\n}","map":{"version":3,"sources":["/home/nino420/Desktop/Application_Seutnauce/ASPAdministrator/src/components/UploadImage.js"],"names":["React","useState","useEffect","firebase","v4","uuid","UploadImage","imageUrl","setImageUrl","readImages","e","file","target","files","id","storageRef","storage","ref","child","imageRef","database","put","getDownloadURL","then","url","set","newState","getImageUrl","on","snapshot","imageUrls","val","urls","push","deleteImage","delete","remove","map"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,QAAP,MAAqB,kBAArB;AACA,SAASC,EAAE,IAAIC,IAAf,QAA2B,MAA3B;AACA,eAAe,SAASC,WAAT,GAAuB;AAAA,kBACJL,QAAQ,CAAC,EAAD,CADJ;AAAA;AAAA,MAC7BM,QAD6B;AAAA,MACnBC,WADmB;;AAEpC,MAAMC,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA,6BAAG,iBAAOC,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACXC,cAAAA,IADW,GACJD,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,CADI;AAEXC,cAAAA,EAFW,GAENT,IAAI,EAFE;AAGXU,cAAAA,UAHW,GAGEZ,QAAQ,CAACa,OAAT,GAAmBC,GAAnB,CAAuB,QAAvB,EAAiCC,KAAjC,CAAuCJ,EAAvC,CAHF;AAIXK,cAAAA,QAJW,GAIAhB,QAAQ,CAACiB,QAAT,GAAoBH,GAApB,CAAwB,QAAxB,EAAkCC,KAAlC,CAAwC,OAAxC,EAAiDA,KAAjD,CAAuDJ,EAAvD,CAJA;AAAA;AAAA,qBAKXC,UAAU,CAACM,GAAX,CAAeV,IAAf,CALW;;AAAA;AAMjBI,cAAAA,UAAU,CAACO,cAAX,GAA4BC,IAA5B,CAAiC,UAACC,GAAD,EAAS;AACxCL,gBAAAA,QAAQ,CAACM,GAAT,CAAaD,GAAb;AACA,oBAAME,QAAQ,gCAAOnB,QAAP,IAAiB;AAAEO,kBAAAA,EAAE,EAAFA,EAAF;AAAMU,kBAAAA,GAAG,EAAHA;AAAN,iBAAjB,EAAd;AACAhB,gBAAAA,WAAW,CAACkB,QAAD,CAAX;AACD,eAJD;;AANiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAVjB,UAAU;AAAA;AAAA;AAAA,KAAhB;;AAaA,MAAMkB,WAAW,GAAG,SAAdA,WAAc,GAAM;AACxB,QAAMR,QAAQ,GAAGhB,QAAQ,CAACiB,QAAT,GAAoBH,GAApB,CAAwB,QAAxB,EAAkCC,KAAlC,CAAwC,OAAxC,CAAjB;AACAC,IAAAA,QAAQ,CAACS,EAAT,CAAY,OAAZ,EAAqB,UAACC,QAAD,EAAc;AACjC,UAAMC,SAAS,GAAGD,QAAQ,CAACE,GAAT,EAAlB;AACA,UAAMC,IAAI,GAAG,EAAb;;AACA,WAAK,IAAIlB,EAAT,IAAegB,SAAf,EAA0B;AACxBE,QAAAA,IAAI,CAACC,IAAL,CAAU;AAAEnB,UAAAA,EAAE,EAAFA,EAAF;AAAMU,UAAAA,GAAG,EAAEM,SAAS,CAAChB,EAAD;AAApB,SAAV;AACD;;AACD,UAAMY,QAAQ,gCAAOnB,QAAP,GAAoByB,IAApB,CAAd;AACAxB,MAAAA,WAAW,CAACkB,QAAD,CAAX;AACD,KARD;AASD,GAXD;;AAYA,MAAMQ,WAAW,GAAG,SAAdA,WAAc,CAACpB,EAAD,EAAQ;AAC1B,QAAMC,UAAU,GAAGZ,QAAQ,CAACa,OAAT,GAAmBC,GAAnB,CAAuB,QAAvB,EAAiCC,KAAjC,CAAuCJ,EAAvC,CAAnB;AACA,QAAMK,QAAQ,GAAGhB,QAAQ,CAACiB,QAAT,GAAoBH,GAApB,CAAwB,QAAxB,EAAkCC,KAAlC,CAAwC,OAAxC,EAAiDA,KAAjD,CAAuDJ,EAAvD,CAAjB;AACAC,IAAAA,UAAU,CAACoB,MAAX,GAAoBZ,IAApB,CAAyB,YAAM;AAC7BJ,MAAAA,QAAQ,CAACiB,MAAT;AACD,KAFD;AAGD,GAND;;AAOAlC,EAAAA,SAAS,CAAC,YAAM;AACdyB,IAAAA,WAAW;AACZ,GAFQ,EAEN,EAFM,CAAT;AAIA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,EAEE;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAmB,IAAA,MAAM,EAAC,SAA1B;AAAoC,IAAA,QAAQ,EAAElB,UAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,EAGGF,QAAQ,GACLA,QAAQ,CAAC8B,GAAT,CAAa,iBAAiB;AAAA,QAAdvB,EAAc,SAAdA,EAAc;AAAA,QAAVU,GAAU,SAAVA,GAAU;AAC5B,WACE;AAAK,MAAA,GAAG,EAAEV,EAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,GAAG,EAAEU,GAAV;AAAe,MAAA,GAAG,EAAC,EAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,EAEE;AAAQ,MAAA,OAAO,EAAE;AAAA,eAAMU,WAAW,CAACpB,EAAD,CAAjB;AAAA,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFF,CADF;AAMD,GAPD,CADK,GASL,EAZN,CADF;AAgBD","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport firebase from '../util/firebase';\nimport { v4 as uuid } from 'uuid';\nexport default function UploadImage() {\n  const [imageUrl, setImageUrl] = useState([]);\n  const readImages = async (e) => {\n    const file = e.target.files[0];\n    const id = uuid();\n    const storageRef = firebase.storage().ref('images').child(id);\n    const imageRef = firebase.database().ref('images').child('daily').child(id);\n    await storageRef.put(file);\n    storageRef.getDownloadURL().then((url) => {\n      imageRef.set(url);\n      const newState = [...imageUrl, { id, url }];\n      setImageUrl(newState);\n    });\n  };\n\n  const getImageUrl = () => {\n    const imageRef = firebase.database().ref('images').child('daily');\n    imageRef.on('value', (snapshot) => {\n      const imageUrls = snapshot.val();\n      const urls = [];\n      for (let id in imageUrls) {\n        urls.push({ id, url: imageUrls[id] });\n      }\n      const newState = [...imageUrl, ...urls];\n      setImageUrl(newState);\n    });\n  };\n  const deleteImage = (id) => {\n    const storageRef = firebase.storage().ref('images').child(id);\n    const imageRef = firebase.database().ref('images').child('daily').child(id);\n    storageRef.delete().then(() => {\n      imageRef.remove();\n    });\n  };\n  useEffect(() => {\n    getImageUrl();\n  }, []);\n\n  return (\n    <div>\n      <h1>Upload imgae</h1>\n      <input type=\"file\" accept=\"image/*\" onChange={readImages} />\n      {imageUrl\n        ? imageUrl.map(({ id, url }) => {\n            return (\n              <div key={id}>\n                <img src={url} alt=\"\" />\n                <button onClick={() => deleteImage(id)}>Delete</button>\n              </div>\n            );\n          })\n        : ''}\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}